!function(t,a,e,n){"use strict";var i={version:"0.0.1",settings:{donut:!1,donut_inner_ratio:.4,percent_offset:35,stroke_color:"#333",stroke_width:0,show_percent:!0,animation_speed:500,always_show_percent:!1,animation_type:"elastic"},init:function(a,n){var i=this;this.scope=a||e.body;var s=t("[data-pie-id]",this.scope);t.extend(!0,this.settings,n),s.length>0?s.each(function(){return i.build(t(this),n)}):this.build(t(this.scope),n),this.events()},events:function(){var e=this;t(a).off(".pizza").on("resize.pizza",e.throttle(function(){e.init()},100)),t(this.scope).off(".pizza").on("mouseenter.pizza mouseleave.pizza touchstart.pizza","[data-pie-id] li",function(a){var e=t(this).parent(),n=Snap(t("#"+e.data("pie-id")+' path[data-id="s'+t(this).index()+'"]')[0]),i=Snap(t(n.node).parent().find('text[data-id="'+n.node.getAttribute("data-id")+'"]')[0]),s=t(this).parent().data("settings");/start/i.test(a.type)&&t(n.node).siblings("path").each(function(){this.nodeName&&(n.animate({transform:"s1 1 "+n.node.getAttribute("data-cx")+" "+n.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),Snap(t(this).next()[0]).animate({opacity:0},s.animation_speed))}),/enter|start/i.test(a.type)?(n.animate({transform:"s1.05 1.05 "+n.node.getAttribute("data-cx")+" "+n.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),s.show_percent&&i.animate({opacity:1},s.animation_speed)):(n.animate({transform:"s1 1 "+n.node.getAttribute("data-cx")+" "+n.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),i.animate({opacity:0},s.animation_speed))})},build:function(a,e){var n=this,i=a;return i.data("settings",t.extend({},n.settings,e,i.data("options"))),n.data(i,e||{}),n.update_DOM(n.pie(i))},data:function(a,e){var n=[];return t("li",a).each(function(){var a=t(this);e.data?n.push({value:e.data[a.index()],color:a.css("color"),segment:a}):n.push({value:a.data("value"),color:a.css("color"),segment:a})}),a.data("graph-data",n)},update_DOM:function(a){var e=a[0],n=a[1];return t(this.identifier(e)).html(n)},pie:function(a){for(var e=a.data("settings"),n=this.svg(a,e),i=a.data("graph-data"),s=0,r=[],o=0,d=t(this.identifier(a)).width()-4,c=0;c<i.length;c++)s+=i[c].value;for(var c=0;c<i.length;c++)r[c]=i[c].value/s*Math.PI*2;for(var c=0;c<i.length;c++){var p=o+r[c],u=d/2,h=d/2,f=d/2*.85;if(!e.donut){var m=u+f*Math.sin(o),l=h-f*Math.cos(o),_=u+f*Math.sin(p),v=h-f*Math.cos(p),g=0;p-o>Math.PI&&(g=1);var y="M"+u+","+h+" L"+m+","+l+" A"+f+","+f+" 0 "+g+" 1 "+_+","+v+" Z"}var x=t('path[data-id="s'+c+'"]',n.node);if(x.length>0)var M=Snap(x[0]);else var M=n.path();var b=i[c].value/s*100,A=t('text[data-id="s'+c+'"]',n.node);if(A.length>0){var R=Snap(A[0]);R.attr({x:u+(f+e.percent_offset)*Math.sin(o+r[c]/2),y:h-(f+e.percent_offset)*Math.cos(o+r[c]/2)})}else var R=M.paper.text(u+(f+e.percent_offset)*Math.sin(o+r[c]/2),h-(f+e.percent_offset)*Math.cos(o+r[c]/2),Math.ceil(b)+"%");var z=R.getBBox().width/2;e.always_show_percent?R.attr({x:R.attr("x")-z,opacity:1}):R.attr({x:R.attr("x")-z,opacity:0}),R.node.setAttribute("data-id","s"+c),M.node.setAttribute("data-cx",u),M.node.setAttribute("data-cy",h),e.donut?this.annular_sector(M.node,{centerX:u,centerY:h,startDegrees:o,endDegrees:p,innerRadius:f*e.donut_inner_ratio,outerRadius:f}):M.attr({d:y}),M.attr({fill:i[c].color,stroke:e.stroke_color,strokeWidth:e.stroke_width}),M.node.setAttribute("data-id","s"+c),this.animate(M,u,h,e),o=p}return[a,n.node]},animate:function(a,e,n,i){a.hover(function(a){var s=Snap(a.target),r=Snap(t(s.node).parent().find('text[data-id="'+s.node.getAttribute("data-id")+'"]')[0]);s.animate({transform:"s1.05 1.05 "+e+" "+n},i.animation_speed,mina[i.animation_type]),r.touchend(function(){s.animate({transform:"s1.05 1.05 "+e+" "+n},i.animation_speed,mina[i.animation_type])}),i.show_percent&&(r.animate({opacity:1},i.animation_speed),r.touchend(function(){r.animate({opacity:1},i.animation_speed)}))},function(a){var s=Snap(a.target),r=Snap(t(s.node).parent().find('text[data-id="'+s.node.getAttribute("data-id")+'"]')[0]);s.animate({transform:"s1 1 "+e+" "+n},i.animation_speed,mina[i.animation_type]),r.animate({opacity:0},i.animation_speed)})},svg:function(a,e){var n=t(this.identifier(a)),i=t("svg",n),s=n.width(),r=s;return i=i.length>0?Snap(i[0]):Snap(s,r),i.node.setAttribute("width",s+e.percent_offset),i.node.setAttribute("height",r+e.percent_offset),i.node.setAttribute("viewBox","-"+e.percent_offset+" -"+e.percent_offset+" "+(s+1.5*e.percent_offset)+" "+(r+1.5*e.percent_offset)),i},annular_sector:function(t,a){function e(t){var a={cx:t.centerX||0,cy:t.centerY||0,startRadians:t.startDegrees||0,closeRadians:t.endDegrees||0},e=t.thickness!==n?t.thickness:100;return t.innerRadius!==n?a.r1=t.innerRadius:t.outerRadius!==n?a.r1=t.outerRadius-e:a.r1=200-e,t.outerRadius!==n?a.r2=t.outerRadius:a.r2=a.r1+e,a.r1<0&&(a.r1=0),a.r2<0&&(a.r2=0),a}var i=e(a),s=[[i.cx+i.r2*Math.sin(i.startRadians),i.cy-i.r2*Math.cos(i.startRadians)],[i.cx+i.r2*Math.sin(i.closeRadians),i.cy-i.r2*Math.cos(i.closeRadians)],[i.cx+i.r1*Math.sin(i.closeRadians),i.cy-i.r1*Math.cos(i.closeRadians)],[i.cx+i.r1*Math.sin(i.startRadians),i.cy-i.r1*Math.cos(i.startRadians)]],r=i.closeRadians-i.startRadians,o=r%(2*Math.PI)>Math.PI?1:0,d=[];d.push("M"+s[0].join()),d.push("A"+[i.r2,i.r2,0,o,1,s[1]].join()),d.push("L"+s[2].join()),d.push("A"+[i.r1,i.r1,0,o,0,s[3]].join()),d.push("z"),t.setAttribute("d",d.join(" "))},identifier:function(t){return"#"+t.data("pie-id")},throttle:function(t,a){var e=null;return function(){var n=this,i=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(n,i)},a)}}};a.Pizza=i}($,this,this.document);